/**
 * Mesour Editable Component - mesour.editable.min.js
 * @author Matous Nemec (http://mesour.com)
 */
/* src/mesour.editable.field.Text.js */
var mesour=!mesour?{}:mesour;mesour._editable=!mesour._editable?{}:mesour._editable;mesour._editable.fields=!mesour._editable.fields?{}:mesour._editable.fields;(function($){mesour._editable.fields.Text=function(a,b,c,d,f,g){this.TYPE=b.TYPE_TEXT;d=d||{};var h=this,fieldName=a['name'],oldValue=c.text(),input=$('<input type="text" value="'+oldValue+'" class="form-control">'),reset=function(){c.empty().text(oldValue)};input.on('keydown.mesour-editable',function(e){if(e.keyCode===13){b.save(fieldName,f)}else if(e.keyCode===27){reset()}});input.css('width','100%');c.empty().append(input);input.focus();this.getInput=function(){return input};this.getValue=function(){return{oldValue:oldValue,value:input.val(),params:d}};this.reset=function(){reset()};this.save=function(){c.empty().text(input.val())}}})(jQuery);
/* src/mesour.editable.field.Enum.js */
(function($){mesour._editable.fields.Enum=function(a,b,c,d,e,f,g){this.TYPE=b.TYPE_ENUM;d=d||{};var h=this,oldValue=c.text(),fieldName=a['name'],g=g?g:a['values'],select=$('<select class="form-control"></select>');select.css('width','100%');for(var i in g){if(!g.hasOwnProperty(i)){continue}var j=$('<option>').attr('value',g[i]['key']).text(g[i]['name']);if(g[i]['key']==f){j.prop('selected',true)}select.append(j)}c.empty().append(select);select.on('change.mesour-editable',function(){b.save(fieldName,e)});this.getSelect=function(){return select};this.getValue=function(){return{oldValue:f,value:select.find(':selected').val(),params:d}};this.reset=function(){c.empty().text(oldValue)};this.save=function(){c.empty().text(select.find(':selected').text())}}})(jQuery);
/* src/mesour.editable.field.Number.js */
mesour._editable.numberFormat=function(b,c,d,e){b=(b+'').replace(/[^0-9+\-Ee.]/g,'');var n=!isFinite(+b)?0:+b,prec=!isFinite(+c)?0:Math.abs(c),sep=(typeof e==='undefined')?',':e,dec=(typeof d==='undefined')?'.':d,s='',toFixedFix=function(n,a){var k=Math.pow(10,a);return''+(Math.round(n*k)/k).toFixed(a)};s=(prec?toFixedFix(n,prec):''+Math.round(n)).split('.');if(s[0].length>3){s[0]=s[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,sep)}if((s[1]||'').length<prec){s[1]=s[1]||'';s[1]+=new Array(prec-s[1].length+1).join('0')}return s.join(dec)};mesour._editable.isNumeric=function(a){var b=" \n\r\t\f\x0b\xa0\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u200b\u2028\u2029\u3000";return(typeof a==='number'||(typeof a==='string'&&b.indexOf(a.slice(-1))===-1))&&a!==''&&!isNaN(a)};(function($){var l=mesour._editable.isNumeric;var m=mesour._editable.numberFormat;mesour._editable.fields.Number=function(b,c,d,f,g){this.TYPE=c.TYPE_NUMBER;f=f||{};var h=new mesour._editable.fields.Text(b,c,d,f,g);var i=this,fieldName=b['name'],unit=b['unit'],separator=b['separator'],decimalPoint=b['decimalPoint'],decimals=b['decimals'],input=h.getInput();function fixNumber(a){return $.trim(a.replace(new RegExp(separator==='.'?'\\.':separator,'g'),'').replace(decimalPoint,'.').replace(unit,''))};input.val(fixNumber(input.val()));input.attr('placeholder',mesour._editable.numberFormat(0,decimals));if(unit){var j=$('<div class="input-group">');input.wrap(j);var k=$('<div class="form-group">');input.closest('.input-group').wrap(k);input.after('<span style="" class="input-group-addon">'+unit+'</span>')}input.focus();input.off('keydown.mesour-editable');input.on('keydown.mesour-editable',function(e){if(e.keyCode===13){var a=mesour._editable.Validators.validateNumber(c,input.val(),input,true);if(a){c.save(fieldName,g)}}else if(e.keyCode===27){h.reset()}});this.getValue=function(){var a=h.getValue();a['oldValue']=fixNumber(a['oldValue']);return a};this.reset=function(){h.reset()};this.save=function(){var a=input.val();d.empty().text(m(a,decimals,decimalPoint,separator)+(unit?(' '+unit):''))}}})(jQuery);
/* src/mesour.editable.field.Date.js */
(function($){mesour._editable.fields.Date=function(a,b,c,d,e){this.TYPE=b.TYPE_DATE;d=d||{};var f=new mesour._editable.fields.Text(a,b,c,d,e);var g=this,fieldName=a['name'],format=a['format'],input=f.getInput();c.parent().css('position','relative');var h=input.val();input.val(!h||h==='-'?'':h);mesour.dateTimePicker.create(input,format,true);mesour.dateTimePicker.show(input);this.getValue=function(){return f.getValue()};this.reset=function(){mesour.dateTimePicker.destroy(input);f.reset()};this.save=function(){mesour.dateTimePicker.destroy(input);f.save()}}})(jQuery);
/* src/mesour.editable.field.Bool.js */
var mesour=!mesour?{}:mesour;mesour._editable=!mesour._editable?{}:mesour._editable;mesour._editable.fields=!mesour._editable.fields?{}:mesour._editable.fields;(function($){mesour._editable.fields.Bool=function(b,c,d,f,g,h){this.TYPE=c.TYPE_TEXT;f=f||{};var i=this,fieldName=b['name'],oldValue=d.text(),input=$('<input type="checkbox" value="1">'),reset=function(){d.empty().text(oldValue)};input.on('change.mesour-editable',function(e){var a=$(this);c.save(fieldName,g)});if(h==1||h==='true'||h===true){input.prop('checked',true)}d.empty().append(input);this.getInput=function(){return input};this.getValue=function(){return{oldValue:h,value:input.is(':checked'),params:f}};this.reset=function(){reset()};this.save=function(){d.empty().text(input.is(':checked')?'Yes':'No')}}})(jQuery);
/* src/mesour.editable.field.OneToOne.js */
(function($){mesour._editable.fields.OneToOne=function(k,l,m,n,o,p){this.TYPE=l.TYPE_ONE_TO_ONE;n=n||{};var q=this,select,oldValue=m.text(),title=k['title'],reference=k['reference'],table=reference['table'],primaryKey=reference['primary_key'],column=reference['column'],fieldName=k['name'],createNewRow=n['create_new_row'];l.getEditableWidget().getReferenceData(l.getName(),table,function(g){g=g.data?g.data:g;var h={};if(createNewRow){h[0]={key:'__add_new_record__',name:'+ Add new record'}}var j=null;for(var i in g){if(!g.hasOwnProperty(i)){continue}if(g[i][primaryKey]==p){j=g[i]}h[g[i][primaryKey]]={key:g[i][primaryKey],name:g[i][column]}}select=new mesour._editable.fields.Enum(k,l,m,n,o,p,h);select.getSelect().off('change.mesour-editable');select.getSelect().on('change.mesour-editable',function(){var c=$(this);if(c.val()==='__add_new_record__'){l.getModal().show();l.getModal().setTitle(title);var d=l.getElementStructure(table);var f=l.getModal().createForm(d.fields?d.fields:d);l.getModal().addHiddenField(f,'__fieldName',fieldName);l.getModal().addHiddenField(f,'__identifier',o);l.getModal().onSubmit(o,function(e,b){q.getValue=function(){var a=select.getValue();a['newValues']=l.getModal().getFormValues(f);if(!j){a['oldValues']={};a['oldValues'][primaryKey]=p}else{a['oldValues']=j}return a};l.create(fieldName,b,f,table);q.getValue=function(){return select.getValue()}})}else{l.save(fieldName,o)}})});this.getValue=function(){return select.getValue()};this.reset=function(){select.reset()};this.save=function(){select.save()}}})(jQuery);
/* src/mesour.editable.field.OneToMany.js */
(function($){mesour._editable.fields.OneToMany=function(h,j,k,l,m,n){this.TYPE=j.TYPE_ONE_TO_MANY;l=l||{};var o=this,select,oldText=k.text(),oldValue=k.attr('data-value'),title=h['title'],reference=h['reference'],table=reference['table'],primaryKey=reference['primary_key'],column=reference['column'],pattern=reference['pattern'],fieldName=h['name'],createNewRow=l['create_new_row'];function getDefaultValues(a,b){b=!b?{}:b;a=!a?{}:a;var c=null;if(b['id']){c={id:b['id']}}return{oldValues:a,newValues:b,params:l,values:c}}j.getEditableWidget().getReferenceData(j.getName(),table,function(b){b=b.data?b.data:b;var c={},hiddenValues={};for(var i in b){if(!b.hasOwnProperty(i)){continue}if(b[i][primaryKey]==n){c=b[i];hiddenValues[column]=b[i][column];break}}j.getModal().show();j.getModal().setTitle(title);var d=j.getElementStructure(table);var f=j.getModal().createForm(d.fields?d.fields:d);j.getModal().fillForm(f,c,hiddenValues);j.getModal().addHiddenField(f,'__fieldName',fieldName);if(m){j.getModal().addHiddenField(f,'__identifier',m);if(n){var g=j.getModal().addHiddenField(f,primaryKey,n);g.attr('data-editable-in-data','true')}}j.getModal().onSubmit(m,function(e,a){o.getValue=function(){return getDefaultValues(c,j.getModal().getFormValues(f))};if(n){j.editForm(fieldName,a,f,table)}else{j.create(fieldName,m,f,table)}o.getValue=function(){return getDefaultValues(c)}})});this.getValue=function(){return getDefaultValues()};this.reset=function(){};this.save=function(){}}})(jQuery);
/* src/mesour.editable.field.ManyToMany.js */
var mesour=!mesour?{}:mesour;mesour._editable=!mesour._editable?{}:mesour._editable;mesour._editable.fields=!mesour._editable.fields?{}:mesour._editable.fields;(function($){mesour._editable.fields.ManyToMany=function(w,x,y,z,A,B){this.TYPE=x.TYPE_MANY_TO_MANY;z=z||{};var C=this,select,oldText=y.text(),oldValue=y.attr('data-value'),title=w['title'],reference=w['reference'],table=reference['table'],referencedTable=reference['referenced_table'],primaryKey=reference['primary_key'],column=reference['column'],selfColumn=reference['self_column'],pattern=reference['pattern'],fieldName=w['name'],createNewRow=z['create_new_row'];function getDefaultValues(a,b,c,d,e){b=!b?{}:b;for(var j in b){if(!b.hasOwnProperty(j)){continue}b[j]=typeof b[j]==='null'||typeof b[j]==='undefinded'?'':b[j]}a=!a?{}:a;var f={reference:{'selfColumn':{name:selfColumn,value:c},'column':{name:column,value:d}},params:z};if(e){return f}f['oldValues']=a;f['newValues']=b;return f}x.getEditableWidget().getReferenceData(x.getName(),table,function(g){var h=g.reference?g.reference:[];g=g.data?g.data:g;var l={};if(B){var m=[];for(var j in h){if(!h.hasOwnProperty(j)){continue}if(h[j][column]==A){m.push(h[j][primaryKey])}}if(!m.length){throw new Error('Referenced id not found.');}}var n=null;if(B){var n=B}for(var i in g){if(!g.hasOwnProperty(i)){continue}if(g[i][primaryKey]==n){l=g[i];break}}x.getModal().show();x.getModal().setTitle(title);var o=x.getElementStructure(table);var p=x.getModal().createForm(o.fields?o.fields:o);if(typeof B==='undefined'){p.find('[data-mesour-has-toggle="new"]').prepend('<h3>'+x.getEditableWidget().getTranslate('createNew')+'</h3>')}x.getModal().fillForm(p,l);x.getModal().addHiddenField(p,'__fieldName',fieldName);if(A){x.getModal().addHiddenField(p,'__identifier',A);if(B){var q=x.getModal().addHiddenField(p,primaryKey,B);q.attr('data-editable-in-data','true')}}if(typeof B==='undefined'){var r=x.getModal().appendToggleForm(p,'old');var s=$('<div class="form-group"><h3>'+x.getEditableWidget().getTranslate('selectExisting')+'</h3></div>');var t=$('<select class="form-control" name="'+selfColumn+'">');var u=[];for(var j in h){if(!h.hasOwnProperty(j)){continue}if(h[j][column]==A){u.push(h[j][selfColumn])}}var v=[];for(var i in g){if(!g.hasOwnProperty(i)){continue}if(u.indexOf(g[i][primaryKey])===-1){v.push(g[i])}}if(u.length>0){t.append('<option value="">'+x.getEditableWidget().getTranslate('select')+'</option>');for(var k=0;k<v.length;k++){t.append('<option value="'+v[k][primaryKey]+'">'+v[k]['name']+'</option>')}}else{t.append('<option>'+x.getEditableWidget().getTranslate('allSelected')+'</option>')}s.append(t);r.append(s)}x.getModal().onSubmit(A,function(e,d){var f=p.find('[name="__type_selector"]');C.getValue=function(){if(f.is('*')&&f.val()==='old'){var a=x.getModal().getFormValues(p);var b=a[selfColumn];delete a[selfColumn];var c=getDefaultValues(l,a,b,d,true);return c}else{return getDefaultValues(l,x.getModal().getFormValues(p),B,d)}};if(f.is('*')&&f.val()==='old'){x.attach(fieldName,d,p,table)}else if(typeof B!=='undefined'){x.editForm(fieldName,d,p,table)}else{x.create(fieldName,A,p,table)}C.getValue=function(){return getDefaultValues(l)}})},referencedTable);this.getValue=function(){return getDefaultValues()};this.reset=function(){};this.save=function(){}}})(jQuery);
/* src/mesour.editable.Validators.js */
(function($){mesour._editable.Validators={validateNumber:function(a,b,c,d){if(!mesour._editable.isNumeric(b.replace(',','.'))){if(!d){c.closest('form').find('.main-form-group:visible:first').prepend(a.createAlert(a.getEditableWidget().getTranslate('invalidNumber'),'danger'))}if(c){c.closest('.form-group').addClass('has-error');c.trigger('focus')}return false}return true}}})(jQuery);
/* src/mesour.editable.FieldEditor.js */
(function($){mesour._editable.FieldEditor=function(a,b,c,d,e){var f=b['name'],type=b['type'],parameters=b['params'],field;if(d){parameters=parameters[d]}if(type===a.TYPE_TEXT){field=new mesour._editable.fields.Text(b,a,c,parameters,d)}else if(type===a.TYPE_NUMBER){field=new mesour._editable.fields.Number(b,a,c,parameters,d)}else if(type===a.TYPE_DATE){field=new mesour._editable.fields.Date(b,a,c,parameters,d)}else if(type===a.TYPE_ENUM){field=new mesour._editable.fields.Enum(b,a,c,parameters,d,e)}else if(type===a.TYPE_BOOL){field=new mesour._editable.fields.Bool(b,a,c,parameters,d,e)}else if(type===a.TYPE_ONE_TO_ONE){field=new mesour._editable.fields.OneToOne(b,a,c,parameters,d,e)}else if(type===a.TYPE_ONE_TO_MANY){field=new mesour._editable.fields.OneToMany(b,a,c,parameters,d,e)}else if(type===a.TYPE_MANY_TO_MANY){field=new mesour._editable.fields.ManyToMany(b,a,c,parameters,d,e)}else{throw new Error('Unknown field type '+type);}this.getValues=function(){return field.getValue()};this.resetValue=function(){return field.reset()};this.saveValue=function(){return field.save()}}})(jQuery);
/* src/mesour.editable.Editable.js */
(function($){mesour._editable.Editable=function(k,l,m){var n=new mesour._editable.EditableModal(k,this);var o=l.fields||[];elements=l.elements||{};this.TYPE_TEXT='text';this.TYPE_NUMBER='number';this.TYPE_DATE='date';this.TYPE_ENUM='enum';this.TYPE_BOOL='bool';this.TYPE_ONE_TO_ONE='one_to_one';this.TYPE_ONE_TO_MANY='one_to_many';this.TYPE_MANY_TO_MANY='many_to_many';var p=this,openedEdits={};this.createAlert=function(a,b,c){b=!b?'danger':b;var d=$('<div class="alert alert-'+b+'">'+a+'</div>');if(typeof c==='undefined'||c){d.prepend('<button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span></button>')}return d};function getFieldStructure(a){for(var i=0;i<o.length;i++){if(o[i]['name']===a){return o[i]}}throw new Error('No structure for field with name '+a);};function removeEditedField(a,b){if(!openedEdits[a]){return}if(b){delete openedEdits[a][b]}else{delete openedEdits[a]}};function getEditedField(a,b,c){c=typeof c==="undefined"?true:c;if(c&&!openedEdits[a]){throw new Error('Field with name '+a+' is not edited');}if(!openedEdits[a])return null;if(b){if(c&&!openedEdits[a][b]){throw new Error('Field with name '+a+' and identifier '+b+' is not edited');}return openedEdits[a][b]}else{if(c&&!openedEdits[a]){throw new Error('Field with name '+a+' is not edited');}return openedEdits[a]}};function editField(a,b,c,d){var e=a['name'];for(var i in openedEdits){if(!openedEdits.hasOwnProperty(i)){continue}if(openedEdits[i]instanceof mesour._editable.FieldEditor){openedEdits[i].resetValue();delete openedEdits[i]}else{for(var j in openedEdits[i]){if(!openedEdits[i].hasOwnProperty(j)){continue}openedEdits[i][j].resetValue();delete openedEdits[i][j]}}}n.enable();if(c){openedEdits[e]=openedEdits[e]||{};openedEdits[e][c]=new mesour._editable.FieldEditor(p,a,b,c,d)}else{openedEdits[e]=new mesour._editable.FieldEditor(p,a,b,c,d)}};this.getElementStructure=function(a){if(!elements[a]){throw new Error('Element with table name '+a+' not exist.');}return elements[a]};this.getEditableWidget=function(){return m};this.getModal=function(){return n};this.getName=function(){return k};this.close=function(a,b){var c=getEditedField(a,b,false);if(c){c.resetValue()}};this.remove=function(a,b,c,d){var e=mesour.core.createLink(k,'remove',postData={name:a,identifier:c,value:d},true);$.post(e[0],e[1]).complete(mesour.core.redrawCallback);m.removeReference(k)};this.newEntry=function(a,b,c){if(!b){throw new Error('Element for edit is required.');}var d=getFieldStructure(a);editField(d,b,c)};this.edit=function(a,b,c,d){if(!b){throw new Error('Element for edit is required.');}var e=getFieldStructure(a);editField(e,b,c,d)};function postCallback(a,b,c,d,f,g,h){try{var i=$.parseJSON(f.responseText);if(i.error){if(h){alert(i.error.message)}else{a.prepend(p.createAlert(i.error.message))}if(i.error.field){var j=a.find('[name="'+i.error.field+'"]');j.closest('.form-group').addClass('has-error');j.trigger('focus')}}}catch(e){d.saveValue();removeEditedField(b,g);mesour.core.redrawCallback(f);if(!h){mesour.editable.removeReference(k,c);n.getModalBody().empty().append(p.createAlert(m.getTranslate('dataSaved'),'success',false));n.disable()}}};this.save=function(a,b){var c=getEditedField(a,b);var d=c.getValues(),postData={name:a,identifier:b,params:d['params'],newValue:d['value'],oldValue:d['oldValue']};var e=mesour.core.createLink(k,'edit',postData,true);$.post(e[0],e[1]).complete(function(r){postCallback(null,a,null,c,r,b,true)})};this.editForm=function(a,b,c,d){var e=getEditedField(a,b);var f=e.getValues(),postData={name:a,identifier:b,params:f['params'],values:f['newValues'],oldValues:f['oldValues']};if(f['reference']){postData['reference']=f['reference']}var g=mesour.core.createLink(k,'editForm',postData,true);$.post(g[0],g[1]).complete(function(r){postCallback(c,a,d,e,r,b)})};this.attach=function(a,b,c,d){var e=getEditedField(a,b);var f=e.getValues(),postData={name:a,identifier:b,params:f['params'],reference:f['reference']};var g=mesour.core.createLink(k,'attach',postData,true);$.post(g[0],g[1]).complete(function(r){postCallback(c,a,d,e,r,b)})};this.create=function(a,b,c,d){var e=getEditedField(a,b);var f=e.getValues(),postData={name:a,params:f['params'],identifier:b,references:f['values'],values:p.getModal().getFormValues(c)};var g=mesour.core.createLink(k,'create',postData,true);$.post(g[0],g[1]).complete(function(r){postCallback(c,a,d,e,r)})}}})(jQuery);
/* src/mesour.editable.EditableModal.js */
(function($){mesour._editable.EditableModal=function(l,m){var n=this,element=$('[data-editable-modal="'+l+'"]'),modalName=element.attr('data-mesour-modal');function toogle(){var a=$(this),group=a.attr('data-mesour-toggle'),others=a.closest('[data-mesour-toggle-group]').find('[data-mesour-toggle]').not(a);element.find('.has-error').removeClass('has-error');element.find('.alert').remove();if(!a.hasClass('active')){others.removeClass('active');a.addClass('active');element.find('input[name="__type_selector"]').val(group);element.find('[data-mesour-has-toggle]').hide();element.find('[data-mesour-has-toggle="'+group+'"]').show()}};function addTextField(a,b,c,d,e){var f=$('<label for="'+b+'">'+c+'</label>');a.append(f);var g=$('<input type="text" class="form-control" id="'+b+'" name="'+d+'">');if(e){g.attr('placeholder',e)}a.append(g);return g};function addCheckboxField(a,b,c,d){var e=$('<label for="'+b+'"> '+c+'</label>');a.append(e);var f=$('<input type="checkbox" id="'+b+'" name="'+d+'">');e.prepend(f);a.append(e);return f};function addGroupToForm(a,b){b=!b?'form-group':b;var c=$('<div class="'+b+'">');a.append(c);return c};function createTogglesGroup(){var a=$('<div class="main-form-group">');var b=addGroupToForm(a);b.append('<label for="__type_selector">'+m.getEditableWidget().getTranslate('selectOne')+'</label>');var c=$('<div class="btn-group" role="group" aria-label="__type_selector" data-mesour-toggle-group="true">');var d=$('<button type="button" class="btn btn-info" data-mesour-toggle="old">'+m.getEditableWidget().getTranslate('attachExisting')+'</button>');var e=$('<button type="button" class="btn btn-info" data-mesour-toggle="new">'+m.getEditableWidget().getTranslate('createNew')+'</button>');d.on('click.mesour-editable-toggle',toogle);e.on('click.mesour-editable-toggle',toogle);c.append(d);c.append(e);d.trigger('click.mesour-editable-toggle');a.append($(c));return a};function createForm(b){var c=$('<form><div class="main-form-group" data-mesour-has-toggle="new">');function addFormGroup(a){return addGroupToForm(c.children('div[data-mesour-has-toggle="new"]'),a)};for(var i in b){if(!b.hasOwnProperty(i)){continue}var d=b[i];if(d['type']===m.TYPE_TEXT){var e=addTextField(addFormGroup(),l+d['name'],d['title'],d['name'],d['title'])}else if(d['type']===m.TYPE_BOOL){var e=addCheckboxField(addFormGroup('checkbox'),l+d['name'],d['title'],d['name'])}else if(d['type']===m.TYPE_NUMBER){var e=addTextField(addFormGroup(),l+d['name'],d['title'],d['name'],mesour._editable.numberFormat(0,d['decimals']));e.attr('data-validate-number','true');if(d['unit']){e.wrap('<div class="input-group">');e.after($('<span style="text-align:right;"  class="input-group-addon">'+d['unit']+'</span>'))}}else if(d['type']===m.TYPE_ENUM){var f=addFormGroup(),id=l+d['name'];var g=$('<label for="'+id+'">'+d['title']+'</label>');f.append(g);var h=$('<select class="form-control" id="'+id+'" placeholder="'+d['title']+'" name="'+d['name']+'">');for(var j in d['values']){if(!d['values'].hasOwnProperty(j)){continue}var k=d['values'][j];h.append('<option value="'+k['key']+'">'+k['name']+'</option>')}f.append(h)}else if(d['type']===m.TYPE_DATE){var e=addTextField(addFormGroup(),l+d['name'],d['title'],d['name'],d['format']);mesour.dateTimePicker.create(e,d['format'])}}return c};this.getName=function(){return modalName};this.show=function(){mesour.modal.show(modalName);mesour.modal.onHide(modalName,function(){var a=element.find('form');m.close(a.find('[name="__fieldName"]').val(),a.find('[name="__identifier"]').val())})};this.setTitle=function(a){var b=element.find('.modal-header'),titleSpan=b.find('.modal-title');if(!titleSpan.is('*')){titleSpan=$('<h4 class="modal-title">');b.append(titleSpan)}titleSpan.empty().text(a)};this.hide=function(){mesour.modal.hide(modalName)};this.onSubmit=function(d,f){var g=function(e){e.preventDefault();var a=element.find('form'),values=n.getFormValues(a);if(d!=a.find('[name="__identifier"]').val()){return}a.find('.has-error').removeClass('has-error');a.find('.alert').remove();var b=true;for(var i in values){if(!values.hasOwnProperty(i)){continue}var c=a.find('[name="'+i+'"]');if(c.attr('data-validate-number')&&c.closest('.main-form-group').is(':visible')&&!mesour._editable.Validators.validateNumber(m,values[i],c)){b=false}}if(b){f(e,a.find('[name="__identifier"]').val())}};n.refresh=function(){var a=element.find('[data-editable-form-save]');a.off('click.mesour-editable');a.on('click.mesour-editable',g)};n.refresh()};this.getModalBody=function(){return mesour.modal.getBody(modalName)};this.disable=function(){element.find('[data-editable-form-save]').hide()};this.enable=function(){element.find('[data-editable-form-save]').show()};this.createForm=function(a){var b=n.getModalBody(),form=createForm(a);b.empty();b.append(form);return form};this.appendToggleForm=function(a,b){n.addHiddenField(a,'__type_selector',b);var c=$('<div class="main-form-group" data-mesour-has-toggle="'+b+'">');a.append(c);a.prepend(createTogglesGroup());return c};this.addHiddenField=function(a,b,c){var d=a.find('input[name="'+b+'"]');if(!d.is('*')){d=$('<input type="hidden" name="'+b+'" value="'+c+'">');a.append(d)}else{d.val(c)}return d};this.getFormValues=function(b){var c={};b.find('input[type=text], select, [data-editable-in-data]').each(function(){var a=$(this);c[a.attr('name')]=a.val()});b.find('input[type=checkbox]').each(function(){var a=$(this);c[a.attr('name')]=a.is(':checked')?true:false});return c};this.fillForm=function(a,b,c){for(var d in b){if(!b.hasOwnProperty(d)){continue}var e=a.find('input[name="'+d+'"], select[name="'+d+'"]');if(e.is('*')){if(e.is('input[type=checkbox]')&&b[d]){e.prop('checked',true)}else{e.val(b[d])}}}for(var d in c){if(!c.hasOwnProperty(d)){continue}var f=n.addHiddenField(a,d,c[d]);f.attr('data-editable-in-data','true')}}}})(jQuery);
/* src/mesour.editable.core.js */
(function($){var m=function(i){var j=this;this.items={};var k={};var l={select:'Select...',selectOne:'Select one',selectExisting:'Select from existing',allSelected:'All existing companies are attachet to this client...',attachExisting:'Attach existing',createNew:'Create new',dataSaved:'Successfuly saved',invalidNumber:'Value must be valid number'};this.enable=function(b){if(j.items[b]){throw new Error('Editable component with name '+b+' already exits');}$.get(mesour.core.createLink(b,'dataStructure')).complete(function(r){try{var a=$.parseJSON(r.responseText).data;j.items[b]=new mesour._editable.Editable(b,a,j)}catch(e){throw e;}})};this.getTranslate=function(a){return l[a]};this.setTranslations=function(a){l=a};this.removeReference=function(a,b){if(b){delete k[a][b]}else{delete k[a]}};this.getReferenceData=function(b,c,d,f){k[b]=k[b]||{};if(!k[b][c]){var g={'table':c,'referencedTable':null};if(f){g['referencedTable']=f}var h=mesour.core.createLink(b,'referenceData',g,true);$.post(h[0],h[1]).complete(function(r){try{var a=$.parseJSON(r.responseText);k[b][c]=a;d(a)}catch(e){mesour.core.redrawCallback(r)}})}else{d(k[b][c])}};this.getComponent=function(a){if(!j.items[a]){throw new Error('Editable component with name '+a+' not exits');}return j.items[a]}};mesour.core.createWidget('editable',new m())})(jQuery);